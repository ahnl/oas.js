window._oas={alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"].sort(),generatedUIDs:[]};class Oas{constructor(a,b){this.options=Object.assign({minDataRows:4,sectionLength:10,readOnly:!1},b),this.selector=a,this.elements=document.querySelectorAll(a),this.render()}generateUIDWithCollisionChecking(){for(;;){let a="oas-"+("0000"+(0|Math.random()*Math.pow(36,4)).toString(36)).slice(-4);if(!window._oas.generatedUIDs.includes(a))return window._oas.generatedUIDs.push(a),a}}isValidAnswerString(a){return new RegExp("^["+window._oas.alphabet.join("")+".]+$").test(a)}addAnswerStringPadding(a){let b=a.length%this.options.sectionLength;return 0==b?a:a+".".repeat(this.options.sectionLength-b)}set readOnly(a){this.options.readOnly=a,this.render()}render(){this.elements.forEach(a=>{var b=Math.max;let c=a.dataset.answers||a.innerHTML;if(c=this.addAnswerStringPadding(c.trim().toUpperCase().replace(/ /g,"")),!this.isValidAnswerString(c))return void console.error("Answer string not valid "+c);a.dataset.answers=c,a.innerHTML="",a.classList.remove("oas__readonly"),this.options.readOnly&&a.classList.add("oas__readonly");let d=c.split("").sort().pop(),e=window._oas.alphabet.indexOf(d)+1;e=b(e,this.options.minDataRows);for(let b,d=0;d<c.length;d+=this.options.sectionLength)b=c.slice(d,d+this.options.sectionLength),this.renderSection(a,b,d,e);a.classList.add("oas__rendered")})}renderSection(a,b,c,d){a.attributes.name||a.setAttribute("name",this.generateUIDWithCollisionChecking());let e=document.createElement("table");e.style.borderCollapse="collapse",e.dataset.sectionIndex=c;let f=document.createElement("thead"),g=document.createElement("tr");for(let e,f=0;f<b.length;f++)e=document.createElement("th"),e.innerHTML=f+1+c,g.appendChild(e);f.appendChild(g);let h=document.createElement("tbody");for(let e,f=0;f<d;f++){e=document.createElement("tr");for(let d=0;d<b.length;d++){let g=document.createElement("td"),h=document.createElement("input");h.type="radio",h.value=window._oas.alphabet[f],h.name="oas__"+a.attributes.name.value+"_"+c+"_"+d,b[d]==window._oas.alphabet[f]&&(h.checked=!0),this.options.readOnly?h.disabled=!0:(h.onmouseup=this.changeEvent,h.oncontextmenu=()=>!1),g.appendChild(h),e.appendChild(g)}h.appendChild(e)}e.appendChild(f),e.appendChild(h),a.appendChild(e)}changeEvent(a){let b=a.target.closest(".oas__rendered"),c=b.dataset.answers.split(""),d=parseInt(a.target.closest("table").dataset.sectionIndex),e=a.target.value[0];3==a.which&&(e=".",a.target.checked=!1),c[d+a.target.parentNode.cellIndex]=e,b.dataset.answers=c.join("")}}